# 智能批量重命名工具 v5.0 (PyQt6版本) 使用说明

## 🎉 恭喜！您的应用已成功升级到PyQt6

您的批量重命名工具已经成功从Tkinter迁移到PyQt6，现在拥有更加现代化、专业的界面！

## ✨ 新版本亮点

### 🎨 视觉升级
- **深色主题**: 采用现代化深色配色方案，减少眼部疲劳
- **圆角设计**: 所有控件都采用圆角设计，更加美观
- **渐变效果**: 按钮具有悬停和点击效果
- **专业配色**: 蓝色主题色 (#4a90e2)，绿色成功色，红色警告色

### 🚀 功能增强
- **拖拽支持**: 直接拖拽文件或文件夹到应用窗口
- **实时预览**: 文件名变更实时显示，颜色区分成功/失败状态
- **进度显示**: 执行重命名时显示进度条
- **状态栏**: 底部显示当前状态和文件计数
- **分割面板**: 左右面板可调整大小

### 💾 配置管理
- **自动保存**: 程序关闭时自动保存配置
- **窗口记忆**: 记住窗口大小和位置
- **配置导入导出**: 支持JSON格式配置文件

## 🖥️ 界面布局

### 左侧配置面板
1. **🌐 全局设置**
   - 日期设置 (YYMMDD格式)

2. **📋 项目代号配置**
   - 可编辑表格，支持添加/删除行
   - 项目代号 → 完整项目名映射

3. **⚙️ 差分规则配置**
   - 差分号、版本名全称、版本名缩写、语言
   - 支持多种差分规则

### 右侧文件处理面板
1. **📁 文件列表与预览**
   - 添加文件/文件夹按钮
   - 文件列表表格，显示原始名称、新名称、状态
   - 支持拖拽添加文件

2. **🚀 执行与历史**
   - 执行重命名按钮
   - 进度条显示
   - 操作历史记录
   - 撤销功能

## 🎯 使用步骤

### 1. 配置项目代号
```
洗衣店偷衣服 → Pre-shoot-洗衣店偷衣服-C02---华容道平铺02-tileflower
插队的补偿   → Pre-shoot-插队的补偿-C01-华容道平铺02tileflower
```

### 2. 配置差分规则
```
差分号: 1  版本名: 核玩翻页        缩写: HWFY  语言: cn
差分号: 2  版本名: 动画quiz-批量化  缩写: BVC   语言: es
差分号: 4  版本名: 核玩新版        缩写: SLT   语言: en
```

### 3. 添加文件
- 点击"📁 添加文件"或"📂 添加文件夹"
- 或直接拖拽文件到窗口中

### 4. 预览结果
- 文件列表会自动显示重命名预览
- ✅ 绿色表示可以重命名
- ❌ 红色表示有错误

### 5. 执行重命名
- 点击"🚀 开始执行重命名"
- 观察进度条和历史记录

## 🔧 高级功能

### 配置管理
- **💾 保存配置**: 导出当前配置到JSON文件
- **📂 加载配置**: 从JSON文件导入配置
- **自动保存**: 程序关闭时自动保存

### 文件名规则
支持的文件名格式：
- `项目代号-差分号` (如: 洗衣店偷衣服-2)
- `项目代号差分号` (如: 洗衣店偷衣服2)

生成的文件名格式：
```
{日期}_{项目名}+{版本名全称}_{语言}_{版本名缩写}_1080x1920.{扩展名}
```

### 拖拽功能
- 支持拖拽单个文件
- 支持拖拽多个文件
- 支持拖拽文件夹（自动添加其中所有文件）

## 🎨 样式特色

### 颜色方案
- **主背景**: #1e1e1e (深黑)
- **次背景**: #2d2d2d (深灰)
- **强调色**: #4a90e2 (蓝色)
- **成功色**: #27ae60 (绿色)
- **警告色**: #e74c3c (红色)

### 控件样式
- **按钮**: 圆角、渐变、悬停效果
- **输入框**: 圆角边框、焦点高亮
- **表格**: 斑马纹、选中高亮
- **滚动条**: 自定义样式、圆角

## 🚀 启动应用

```bash
# 确保已安装PyQt6
pip install PyQt6

# 启动应用
python batch_renamer_pyqt.py
```

## 🧪 测试功能

```bash
# 创建测试文件
python test_pyqt_app.py

# 然后将test_files文件夹中的文件拖拽到应用中测试
```

## 📝 技术特点

### 架构优势
- **MVC模式**: 清晰的数据和界面分离
- **事件驱动**: 响应式用户交互
- **类型提示**: 完整的Python类型注解
- **异常处理**: 完善的错误处理机制

### 性能优化
- **惰性加载**: 按需创建界面元素
- **内存管理**: 自动垃圾回收
- **响应式**: 非阻塞用户界面
- **批量处理**: 高效的文件操作

## 🔄 从Tkinter版本迁移

如果您之前使用Tkinter版本，配置文件完全兼容：
- `window_config.json` - 窗口配置
- `auto_config.json` - 自动保存的配置

## 🎯 下一步计划

可以考虑的进一步增强：
1. **主题切换**: 支持亮色/暗色主题切换
2. **插件系统**: 支持自定义重命名规则
3. **批量操作**: 支持更多批量文件操作
4. **云同步**: 配置文件云端同步
5. **多语言**: 界面多语言支持

## 🎉 享受您的新工具！

现在您拥有了一个专业级的批量重命名工具，具有现代化的界面和强大的功能。PyQt6为您提供了更好的用户体验和更强的扩展性。

祝您使用愉快！ 🚀✨
